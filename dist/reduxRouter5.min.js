!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.reduxRouter5={})}(this,function(t){"use strict";var e="@@router5/NAVIGATE",r="@@router5/CANCEL",n="@@router5/TRANSITION_ERROR",o="@@router5/TRANSITION_SUCCESS",a="@@router5/TRANSITION_START",u="@@router5/CLEAR_ERRORS",i="@@router5/CAN_DEACTIVATE",c="@@router5/CAN_ACTIVATE",s=Object.freeze({NAVIGATE_TO:e,CANCEL_TRANSITION:r,TRANSITION_ERROR:n,TRANSITION_SUCCESS:o,TRANSITION_START:a,CLEAR_ERRORS:u,CAN_DEACTIVATE:i,CAN_ACTIVATE:c});function l(t,e){return{type:a,payload:{route:t,previousRoute:e}}}function f(t,e){return{type:o,payload:{route:t,previousRoute:e}}}function p(t,e,r){return{type:n,payload:{route:t,previousRoute:e,transitionError:r}}}var v=Object.freeze({navigateTo:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{type:e,payload:{name:t,params:r,opts:n}}},cancelTransition:function(){return{type:r}},clearErrors:function(){return{type:u}},transitionStart:l,transitionSuccess:f,transitionError:p,canActivate:function(t,e){return{type:c,payload:{name:t,canActivate:e}}},canDeactivate:function(t,e){return{type:i,payload:{name:t,canDeactivate:e}}}});function y(t){function e(){return{onTransitionStart:function(e,r){t(l(e,r))},onTransitionSuccess:function(e,r){t(f(e,r))},onTransitionError:function(e,r,n){t(p(e,r,n))}}}return e.pluginName="REDUX_PLUGIN",e}var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},m={route:null,previousRoute:null,transitionRoute:null,transitionError:null};var A="function"==typeof Symbol&&"symbol"===d(Symbol.iterator)?function(t){return void 0===t?"undefined":d(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":d(t)};function T(t){return t.split(".").reduce(function(t,e){return t.concat(t.length?t[t.length-1]+"."+e:e)},[])}function S(t){return t&&t.meta&&t.meta.params}function E(t,e){return S(e)&&(void 0!==(r=e.meta.params[t])&&null!==r)?Object.keys(e.meta.params[t]).reduce(function(t,r){return t[r]=e.params[r],t},{}):{};var r}function b(t){return function(e,r){var n=function(t,e){var r=e?T(e.name):[],n=T(t.name),o=Math.min(r.length,n.length),a=void 0;a=e&&(S(e)||S(t))?function(){var a=void 0,u=function(){var o=r[a],u=n[a];if(o!==u)return{v:a};var i=E(o,t),c=E(u,e);return i.length!==c.length?{v:a}:0===i.length?"continue":Object.keys(i).some(function(t){return c[t]!==i[t]})?{v:a}:void 0};for(a=0;a<o;a+=1){var i=u();switch(i){case"continue":continue;default:if("object"===(void 0===i?"undefined":A(i)))return i.v}}return a}():0;var u=r.slice(a).reverse(),i=n.slice(a);return{intersection:e&&a>0?r[a-1]:"",toDeactivate:u,toActivate:i}}(e,r),o=n.intersection,a=n.toActivate,u=n.toDeactivate,i=[].concat(function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}(u)).reverse();if(e.meta.options&&e.meta.options.reload)return!0;if(t===o)return!0;if(-1===a.indexOf(t))return!1;for(var c=!0,s=0;s<a.length;s+=1){var l=a[s];if((c=l===i[s])&&l===t)return!0;if(!c)return!1}return!1}}t.router5Middleware=function(t){return function(n){var o=n.dispatch;return t.setDependency("store",n),t.usePlugin(y(o)),function(n){return function(o){switch(o.type){case e:t.navigate(o.payload.name,o.payload.params,o.payload.opts);break;case r:t.cancel();break;case i:t.canDeactivate(o.payload.name,o.payload.canDeactivate);break;case c:t.canActivate(o.payload.name,o.payload.canDeactivate);break;default:return n(o)}}}}},t.router5Reducer=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,e=arguments[1];switch(e.type){case a:return R({},t,{transitionRoute:e.payload.route,transitionError:null});case o:return R({},t,{transitionRoute:null,transitionError:null,previousRoute:e.payload.previousRoute,route:e.payload.route});case n:return R({},t,{transitionRoute:e.payload.route,transitionError:e.payload.transitionError});case u:return R({},t,{transitionRoute:null,transitionError:null});default:return t}},t.actions=v,t.actionTypes=s,t.createRouteNodeSelector=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"router",r=void 0;return function(n){var o=function(t){return t[e]||t.get&&t.get(e)}(n),a=o.route,u=o.previousRoute,i=!a||b(t)(a,u);return r?(!u||u!==a&&i)&&(r={route:a,previousRoute:u}):r={route:a,previousRoute:u},r}},t.reduxPlugin=y,Object.defineProperty(t,"__esModule",{value:!0})});
